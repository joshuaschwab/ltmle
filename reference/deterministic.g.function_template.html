<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Template for the deterministic.g.function 
argument to ltmle or ltmleMSM."><title>Deterministic g/Q functions - examples and templates — deterministic.g.function_template • ltmle</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Deterministic g/Q functions - examples and templates — deterministic.g.function_template"><meta property="og:description" content="Template for the deterministic.g.function 
argument to ltmle or ltmleMSM."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ltmle</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3-0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a01_overview.html">ltmle Package Overview</a>
    <a class="dropdown-item" href="../articles/a02_intro.html">Introduction to ltmle</a>
    <a class="dropdown-item" href="../articles/a03_msm.html">Marginal Structural Models - ltmleMSM</a>
    <a class="dropdown-item" href="../articles/a04_deterministic-functions.html">Deterministic Functions</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/joshuaschwab/ltmle/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Deterministic g/Q functions - examples and templates</h1>
      <small class="dont-index">Source: <a href="https://github.com/joshuaschwab/ltmle/blob/HEAD/R/DeterministicFunctions.R" class="external-link"><code>R/DeterministicFunctions.R</code></a></small>
      <div class="d-none name"><code>deterministic.g.function_template.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Template for the <code>deterministic.g.function</code> 
argument to <code>ltmle</code> or <code>ltmleMSM</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">deterministic.g.function_template</span><span class="op">(</span><span class="va">data</span>, <span class="va">current.node</span>, <span class="va">nodes</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">deterministic.Q.function_template</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">current.node</span>,</span>
<span>  <span class="va">nodes</span>,</span>
<span>  <span class="va">called.from.estimate.g</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>the 'data' data.frame passed to <code>ltmle</code> or <code>ltmleMSM</code></p></dd>


<dt>current.node</dt>
<dd><p>the column index of data corresponding to the A or C
node (for g) or L or Y node (for Q)</p></dd>


<dt>nodes</dt>
<dd><p>list of column indicies, components:</p><ul><li><p><code>A</code>
Anodes (treatment)</p></li>
<li><p><code>C</code> Cnodes (censoring)</p></li>
<li><p><code>L</code> Lnodes
(time-varying covariates)</p></li>
<li><p><code>Y</code> Ynodes (events)</p></li>
<li><p><code>AC</code>
Anodes and Cnodes combined and sorted</p></li>
<li><p><code>LY</code> Lnodes and Ynodes
combined, sorted, "blocks" removed - see <code>ltmle</code></p></li>
</ul></dd>


<dt>called.from.estimate.g</dt>
<dd><p>TRUE or FALSE - your function will be called
with <code>called.from.estimate.g=TRUE</code> during estimation of g and
<code>called.from.estimate.g=FALSE</code> during estimation of Q.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A deterministic.g.function should return a list with components:</p>
<dl><dt>is.deterministic </dt>
<dd><p>vector of logicals, length=nrow(data)</p></dd>
 <dt>prob1
</dt>
<dd><p>the probability that data[is.deterministic, current.node] == 1, vector of
length 1 or length(which(is.deterministic))</p></dd>
</dl><p>A deterministic.Q.function
should return a list with components:</p>
<dl><dt>is.deterministic </dt>
<dd><p>vector of
logicals, length=nrow(data)</p></dd>
 <dt>Q.value</dt>
<dd><p>the iterated expectation of the
final Y, vector of length 1 or length(which(is.deterministic))</p></dd>


</dl><p>NOTE: The <code>Q.value</code> component is not used or required when
<code>called.from.estimate.g</code> is <code>TRUE</code></p>


    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>MaintainTreatment</code> and <code>MaintainControl</code> are two commonly used
<code>deterministic.g.function</code>s.</p>
<p>The intended use of the templates is for the user to copy and paste the
function arguments and body and then fill in the required sections. They
will not run as-is. Note that there are no comments in the functions as
saved. Versions with comments may be found in Examples section below.</p>
<p>MaintainTreatment and MaintainControl may be passed as-is for the
<code>deterministic.g.function</code> argument to <code>ltmle</code> or
<code>ltmleMSM</code></p>
<p>Note that censoring nodes in <code>data</code> may be passed as binaries but they
are converted to the preferred format of factors with levels "censored" and
"uncensored" before deterministic functions are called.  Also note that
nodes may be passed to ltmle as either the names of nodes or numerical
column indicies, but they are all converted to numerical indicies before
deterministic functions are called.  If the <code>survivalFunction</code> argument
to <code>ltmle</code> or <code>ltmleMSM</code> is <code>TRUE</code>, the package automatically
assumes that once Y jumps to 1, all future Y nodes stay 1 and treatment does
not change. It is not necessary to specify this in deterministic functions.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>
    
<ul><li><p><code>deterministic.Q.function_template()</code>: Template for the <code>deterministic.Q.function</code> 
argument to <code>ltmle</code> or <code>ltmleMSM</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>ltmle</code>, <code>ltmleMSM</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Joshua Schwab <a href="mailto:jschwab77@berkeley.edu">jschwab77@berkeley.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show template for a deterministic.g.function (comments will not be</span></span></span>
<span class="r-in"><span><span class="co"># shown, see below for comments)</span></span></span>
<span class="r-in"><span><span class="va">deterministic.g.function_template</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (data, current.node, nodes) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is.deterministic &lt;- stop("replace me!")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     prob1 &lt;- stop("replace me!")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return(list(is.deterministic = is.deterministic, prob1 = prob1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55916e7f0ea0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: namespace:ltmle&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show template for a deterministic.Q.function (comments will not be</span></span></span>
<span class="r-in"><span><span class="co"># shown, see below for comments)</span></span></span>
<span class="r-in"><span><span class="va">deterministic.Q.function_template</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (data, current.node, nodes, called.from.estimate.g) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     is.deterministic &lt;- stop("replace me!")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Q.value &lt;- stop("replace me!")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return(list(is.deterministic = is.deterministic, Q.value = Q.value))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x55916e885cb0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: namespace:ltmle&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use MaintainTreatment</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rexpit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A1</span> <span class="op">&lt;-</span> <span class="fu">rexpit</span><span class="op">(</span><span class="va">W</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu">rexpit</span><span class="op">(</span><span class="va">W</span><span class="op">)</span> <span class="op">|</span> <span class="va">A1</span><span class="op">)</span>  <span class="co">#treatment at time 1 implies treatment at time 2</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu">rexpit</span><span class="op">(</span><span class="va">W</span> <span class="op">+</span> <span class="va">A1</span> <span class="op">+</span> <span class="va">A2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">W</span>, <span class="va">A1</span>, <span class="va">A2</span>, <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">ltmle</span><span class="op">(</span><span class="va">data</span>, Anodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span><span class="op">)</span>, Ynodes <span class="op">=</span> <span class="st">"Y"</span>, abar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    deterministic.g.function <span class="op">=</span> <span class="va">MaintainTreatment</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Qform not specified, using defaults:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> formula for Y:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Q.kplus1 ~ W + A1 + A2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> gform not specified, using defaults:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> formula for A1:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> A1 ~ W</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> formula for A2:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> A2 ~ W + A1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimate of time to completion: &lt; 1 minute</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># deterministic.g.function_template with comments:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">deterministic.g.function_template</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">current.node</span>, <span class="va">nodes</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># data: the 'data' data.frame passed to ltmle/ltmleMSM current.node: the</span></span></span>
<span class="r-in"><span>    <span class="co"># column index of data corresponding to the A or C node (see</span></span></span>
<span class="r-in"><span>    <span class="co"># is.deterministic below) nodes: list of column indicies, components: A,</span></span></span>
<span class="r-in"><span>    <span class="co"># C, L, Y, AC (Anodes and Cnodes combined and sorted), LY (Lnodes and</span></span></span>
<span class="r-in"><span>    <span class="co"># Ynodes combined, sorted, 'blocks' removed - see ?ltmle) Note that nodes</span></span></span>
<span class="r-in"><span>    <span class="co"># may be passed to ltmle as either the names of nodes or numerical column</span></span></span>
<span class="r-in"><span>    <span class="co"># indicies, but they are all converted to numerical indicies before</span></span></span>
<span class="r-in"><span>    <span class="co"># deterministic.g.function is called</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># deterministic.g.function will be called at all Anodes and Cnodes</span></span></span>
<span class="r-in"><span>    <span class="co"># return(NULL) is equivalent to return(list(is.deterministic=rep(FALSE,</span></span></span>
<span class="r-in"><span>    <span class="co"># nrow(data)), prob1=numeric(0)))</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># define is.deterministic here: vector of logicals, length=nrow(data)</span></span></span>
<span class="r-in"><span>    <span class="co"># define prob1 here: the probability that data[is.deterministic,</span></span></span>
<span class="r-in"><span>    <span class="co"># current.node] == 1, vector of length 1 or</span></span></span>
<span class="r-in"><span>    <span class="co"># length(which(is.deterministic))</span></span></span>
<span class="r-in"><span>    <span class="va">is.deterministic</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"replace me!"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">prob1</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"replace me!"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>is.deterministic <span class="op">=</span> <span class="va">is.deterministic</span>, prob1 <span class="op">=</span> <span class="va">prob1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># deterministic.Q.function_template with comments:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">deterministic.Q.function_template</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">current.node</span>, <span class="va">nodes</span>, </span></span>
<span class="r-in"><span>    <span class="va">called.from.estimate.g</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># data: the 'data' data.frame passed to ltmle/ltmleMSM current.node: the</span></span></span>
<span class="r-in"><span>    <span class="co"># column index of data corresponding to the A or C node (see</span></span></span>
<span class="r-in"><span>    <span class="co"># is.deterministic below) nodes: list of column indicies, components: A,</span></span></span>
<span class="r-in"><span>    <span class="co"># C, L, Y, AC (Anodes and Cnodes combined and sorted), LY (Lnodes and</span></span></span>
<span class="r-in"><span>    <span class="co"># Ynodes combined, sorted, 'blocks' removed - see ?ltmle)</span></span></span>
<span class="r-in"><span>    <span class="co"># called.from.estimate.g: TRUE or FALSE - your function will be called</span></span></span>
<span class="r-in"><span>    <span class="co"># with called.from.estimate.g=TRUE during estimation of g and</span></span></span>
<span class="r-in"><span>    <span class="co"># called.from.estimate.g=FALSE during estimation of Q. During estimation</span></span></span>
<span class="r-in"><span>    <span class="co"># of g, only the is.deterministic element of the return list will be</span></span></span>
<span class="r-in"><span>    <span class="co"># used.  Note that nodes may be passed to ltmle as either the names of</span></span></span>
<span class="r-in"><span>    <span class="co"># nodes or numerical column indicies, but they are all converted to</span></span></span>
<span class="r-in"><span>    <span class="co"># numerical indicies before deterministic.Q.function is called</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># It is not necessary to specify that deterministic Y events (Y==1)</span></span></span>
<span class="r-in"><span>    <span class="co"># indicate a deterministic Q value of 1; this is automatic </span></span></span>
<span class="r-in"><span>    <span class="co"># if the survivalFunction input to ltmle/ltmleMSM is TRUE.</span></span></span>
<span class="r-in"><span>    <span class="co"># deterministic.Q.function will be called at all Lnodes and Ynodes (after</span></span></span>
<span class="r-in"><span>    <span class="co"># removing 'blocks') and Anodes and Cnodes (see called.from.estimate.g</span></span></span>
<span class="r-in"><span>    <span class="co"># above) return(NULL) is equivalent to</span></span></span>
<span class="r-in"><span>    <span class="co"># return(list(is.deterministic=rep(FALSE, nrow(data)),</span></span></span>
<span class="r-in"><span>    <span class="co"># Q.value=numeric(0)))</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span>    <span class="co"># define is.deterministic here: vector of logicals, length=nrow(data)</span></span></span>
<span class="r-in"><span>    <span class="co"># define Q.value here: the iterated expectation of the final Y, vector of</span></span></span>
<span class="r-in"><span>    <span class="co"># length 1 or length(which(is.deterministic))</span></span></span>
<span class="r-in"><span>    <span class="va">is.deterministic</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"replace me!"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">Q.value</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"replace me!"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>is.deterministic <span class="op">=</span> <span class="va">is.deterministic</span>, Q.value <span class="op">=</span> <span class="va">Q.value</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Joshua Schwab, Samuel Lendle, Maya Petersen, Mark van der Laan.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

